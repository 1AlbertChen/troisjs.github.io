import{Z as t}from"./OrbitControls.ee6c153c.js";import{A as e,B as r,a as i,I as s,f as a,p as o,c as n,d as h,S as m}from"./trois.module.ad13c1cd.js";import{c as f}from"./_commonjsHelpers.e8df9aad.js";import{r as l,o as d,c as u,w as c,a as v}from"./app.39908f78.js";const p=new(f((function(t,e){!function(){var r=.5*(Math.sqrt(3)-1),i=(3-Math.sqrt(3))/6,s=1/6,a=(Math.sqrt(5)-1)/4,o=(5-Math.sqrt(5))/20;function n(t){var e;e="function"==typeof t?t:t?function(){var t=0,e=0,r=0,i=1,s=m();t=s(" "),e=s(" "),r=s(" ");for(var a=0;a<arguments.length;a++)(t-=s(arguments[a]))<0&&(t+=1),(e-=s(arguments[a]))<0&&(e+=1),(r-=s(arguments[a]))<0&&(r+=1);return s=null,function(){var s=2091639*t+2.3283064365386963e-10*i;return t=e,e=r,r=s-(i=0|s)}}(t):Math.random,this.p=h(e),this.perm=new Uint8Array(512),this.permMod12=new Uint8Array(512);for(var r=0;r<512;r++)this.perm[r]=this.p[255&r],this.permMod12[r]=this.perm[r]%12}function h(t){var e,r=new Uint8Array(256);for(e=0;e<256;e++)r[e]=e;for(e=0;e<255;e++){var i=e+~~(t()*(256-e)),s=r[e];r[e]=r[i],r[i]=s}return r}function m(){var t=4022871197;return function(e){e=e.toString();for(var r=0;r<e.length;r++){var i=.02519603282416938*(t+=e.charCodeAt(r));i-=t=i>>>0,t=(i*=t)>>>0,t+=4294967296*(i-=t)}return 2.3283064365386963e-10*(t>>>0)}}n.prototype={grad3:new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]),grad4:new Float32Array([0,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,1,0,1,1,1,0,1,-1,1,0,-1,1,1,0,-1,-1,-1,0,1,1,-1,0,1,-1,-1,0,-1,1,-1,0,-1,-1,1,1,0,1,1,1,0,-1,1,-1,0,1,1,-1,0,-1,-1,1,0,1,-1,1,0,-1,-1,-1,0,1,-1,-1,0,-1,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,0]),noise2D:function(t,e){var s,a,o=this.permMod12,n=this.perm,h=this.grad3,m=0,f=0,l=0,d=(t+e)*r,u=Math.floor(t+d),c=Math.floor(e+d),v=(u+c)*i,p=t-(u-v),M=e-(c-v);p>M?(s=1,a=0):(s=0,a=1);var g=p-s+i,w=M-a+i,y=p-1+2*i,I=M-1+2*i,A=255&u,N=255&c,P=.5-p*p-M*M;if(P>=0){var S=3*o[A+n[N]];m=(P*=P)*P*(h[S]*p+h[S+1]*M)}var x=.5-g*g-w*w;if(x>=0){var D=3*o[A+s+n[N+a]];f=(x*=x)*x*(h[D]*g+h[D+1]*w)}var E=.5-y*y-I*I;if(E>=0){var C=3*o[A+1+n[N+1]];l=(E*=E)*E*(h[C]*y+h[C+1]*I)}return 70*(m+f+l)},noise3D:function(t,e,r){var i,a,o,n,h,m,f,l,d,u,c=this.permMod12,v=this.perm,p=this.grad3,M=.3333333333333333*(t+e+r),g=Math.floor(t+M),w=Math.floor(e+M),y=Math.floor(r+M),I=(g+w+y)*s,A=t-(g-I),N=e-(w-I),P=r-(y-I);A>=N?N>=P?(h=1,m=0,f=0,l=1,d=1,u=0):A>=P?(h=1,m=0,f=0,l=1,d=0,u=1):(h=0,m=0,f=1,l=1,d=0,u=1):N<P?(h=0,m=0,f=1,l=0,d=1,u=1):A<P?(h=0,m=1,f=0,l=0,d=1,u=1):(h=0,m=1,f=0,l=1,d=1,u=0);var S=A-h+s,x=N-m+s,D=P-f+s,E=A-l+2*s,C=N-d+2*s,_=P-u+2*s,Z=A-1+.5,b=N-1+.5,U=P-1+.5,j=255&g,z=255&w,G=255&y,q=.6-A*A-N*N-P*P;if(q<0)i=0;else{var B=3*c[j+v[z+v[G]]];i=(q*=q)*q*(p[B]*A+p[B+1]*N+p[B+2]*P)}var H=.6-S*S-x*x-D*D;if(H<0)a=0;else{var L=3*c[j+h+v[z+m+v[G+f]]];a=(H*=H)*H*(p[L]*S+p[L+1]*x+p[L+2]*D)}var V=.6-E*E-C*C-_*_;if(V<0)o=0;else{var R=3*c[j+l+v[z+d+v[G+u]]];o=(V*=V)*V*(p[R]*E+p[R+1]*C+p[R+2]*_)}var T=.6-Z*Z-b*b-U*U;if(T<0)n=0;else{var W=3*c[j+1+v[z+1+v[G+1]]];n=(T*=T)*T*(p[W]*Z+p[W+1]*b+p[W+2]*U)}return 32*(i+a+o+n)},noise4D:function(t,e,r,i){var s,n,h,m,f,l,d,u,c,v,p,M,g,w,y,I,A,N=this.perm,P=this.grad4,S=(t+e+r+i)*a,x=Math.floor(t+S),D=Math.floor(e+S),E=Math.floor(r+S),C=Math.floor(i+S),_=(x+D+E+C)*o,Z=t-(x-_),b=e-(D-_),U=r-(E-_),j=i-(C-_),z=0,G=0,q=0,B=0;Z>b?z++:G++,Z>U?z++:q++,Z>j?z++:B++,b>U?G++:q++,b>j?G++:B++,U>j?q++:B++;var H=Z-(l=z>=3?1:0)+o,L=b-(d=G>=3?1:0)+o,V=U-(u=q>=3?1:0)+o,R=j-(c=B>=3?1:0)+o,T=Z-(v=z>=2?1:0)+2*o,W=b-(p=G>=2?1:0)+2*o,Y=U-(M=q>=2?1:0)+2*o,$=j-(g=B>=2?1:0)+2*o,F=Z-(w=z>=1?1:0)+3*o,X=b-(y=G>=1?1:0)+3*o,O=U-(I=q>=1?1:0)+3*o,k=j-(A=B>=1?1:0)+3*o,J=Z-1+4*o,K=b-1+4*o,Q=U-1+4*o,tt=j-1+4*o,et=255&x,rt=255&D,it=255&E,st=255&C,at=.6-Z*Z-b*b-U*U-j*j;if(at<0)s=0;else{var ot=N[et+N[rt+N[it+N[st]]]]%32*4;s=(at*=at)*at*(P[ot]*Z+P[ot+1]*b+P[ot+2]*U+P[ot+3]*j)}var nt=.6-H*H-L*L-V*V-R*R;if(nt<0)n=0;else{var ht=N[et+l+N[rt+d+N[it+u+N[st+c]]]]%32*4;n=(nt*=nt)*nt*(P[ht]*H+P[ht+1]*L+P[ht+2]*V+P[ht+3]*R)}var mt=.6-T*T-W*W-Y*Y-$*$;if(mt<0)h=0;else{var ft=N[et+v+N[rt+p+N[it+M+N[st+g]]]]%32*4;h=(mt*=mt)*mt*(P[ft]*T+P[ft+1]*W+P[ft+2]*Y+P[ft+3]*$)}var lt=.6-F*F-X*X-O*O-k*k;if(lt<0)m=0;else{var dt=N[et+w+N[rt+y+N[it+I+N[st+A]]]]%32*4;m=(lt*=lt)*lt*(P[dt]*F+P[dt+1]*X+P[dt+2]*O+P[dt+3]*k)}var ut=.6-J*J-K*K-Q*Q-tt*tt;if(ut<0)f=0;else{var ct=N[et+1+N[rt+1+N[it+1+N[st+1]]]]%32*4;f=(ut*=ut)*ut*(P[ct]*J+P[ct+1]*K+P[ct+2]*Q+P[ct+3]*tt)}return 27*(s+n+h+m+f)}},n._buildPermutationTable=h,e.SimplexNoise=n,t.exports=n}()}))),M={components:{AmbientLight:e,BoxGeometry:r,Camera:i,InstancedMesh:s,PhongMaterial:a,Plane:o,PointLight:n,Renderer:h,Scene:m},setup:()=>({SIZE:1.5,NX:20,NY:20,PADDING:1,SIZEP:2.5,W:49,H:49,NUM_INSTANCES:400}),data:()=>({}),mounted(){this.renderer=this.$refs.renderer,this.mouse=this.renderer.three.mouse,this.mouseV3=this.renderer.three.mouseV3,this.imesh=this.$refs.imesh.mesh,this.light=this.$refs.light.light,this.dummy=new t,this.renderer.onBeforeRender(this.animate)},methods:{animate(){this.light.position.x=this.mouseV3.x,this.light.position.y=this.mouseV3.y,this.updateInstanceMatrix()},updateInstanceMatrix(){const t=-this.W/2+this.PADDING,e=-this.H/2+this.PADDING,r=1e-4*Date.now(),i=.1*this.mouse.x,s=.1*this.mouse.y;let a,o,n,h,m,f;for(let l=0;l<this.NX;l++)for(let d=0;d<this.NY;d++)a=t+l*this.SIZEP,o=e+d*this.SIZEP,n=.005*a+i,h=.005*o+s,m=p.noise3D(n,h,r)*Math.PI,f=p.noise3D(h,n,r)*Math.PI,this.dummy.position.set(a,o,-10),this.dummy.rotation.set(m,f,0),this.dummy.updateMatrix(),this.imesh.setMatrixAt(l*this.NY+d,this.dummy.matrix);this.imesh.instanceMatrix.needsUpdate=!0}}};M.render=function(t,e,r,i,s,a){const o=l("Camera"),n=l("AmbientLight"),h=l("PointLight"),m=l("BoxGeometry"),f=l("PhongMaterial"),p=l("InstancedMesh"),M=l("Plane"),g=l("Scene"),w=l("Renderer");return d(),u(w,{ref:"renderer",antialias:"","orbit-ctrl":"","mouse-move":"","mouse-raycast":"",shadow:""},{default:c((()=>[v(o,{position:{z:20}}),v(g,null,{default:c((()=>[v(n,{color:"#808080"}),v(h,{ref:"light","cast-shadow":"","shadow-map-size":{width:1024,height:1024}},null,512),v(p,{ref:"imesh",count:i.NUM_INSTANCES,"cast-shadow":"","receive-shadow":""},{default:c((()=>[v(m,{size:i.SIZE},null,8,["size"]),v(f,{color:"#9C1E15"})])),_:1},8,["count"]),v(M,{width:2*i.W,height:2*i.H,position:{z:-10-i.SIZE},"receive-shadow":""},{default:c((()=>[v(f,{color:"#9C1E15"})])),_:1},8,["width","height","position"])])),_:1})])),_:1},512)};export default M;
