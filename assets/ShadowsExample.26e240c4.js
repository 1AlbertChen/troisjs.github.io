import{a3 as t}from"./OrbitControls.94891aa4.js";import{A as e,B as i,a as s,I as o,e as a,p as r,c as n,R as h,S as d}from"./trois.module.3e50b12e.js";import{s as m}from"./simplex-noise.dcc68382.js";import{r as p,o as l,c,w as u,b as f}from"./app.e8a5d5a3.js";const I=new m,g={components:{AmbientLight:e,BoxGeometry:i,Camera:s,InstancedMesh:o,PhongMaterial:a,Plane:r,PointLight:n,Renderer:h,Scene:d},setup:()=>({SIZE:1.5,NX:20,NY:20,PADDING:1,SIZEP:2.5,W:49,H:49,NUM_INSTANCES:400}),data:()=>({}),mounted(){this.renderer=this.$refs.renderer,this.pointer=this.renderer.three.pointer,this.imesh=this.$refs.imesh.mesh,this.light=this.$refs.light.light,this.dummy=new t,this.renderer.onBeforeRender(this.animate)},methods:{animate(){this.light.position.x=this.pointer.positionV3.x,this.light.position.y=this.pointer.positionV3.y,this.updateInstanceMatrix()},updateInstanceMatrix(){const t=-this.W/2+this.PADDING,e=-this.H/2+this.PADDING,i=1e-4*Date.now(),s=.1*this.pointer.positionN.x,o=.1*this.pointer.positionN.y;let a,r,n,h,d,m;for(let p=0;p<this.NX;p++)for(let l=0;l<this.NY;l++)a=t+p*this.SIZEP,r=e+l*this.SIZEP,n=.005*a+s,h=.005*r+o,d=I.noise3D(n,h,i)*Math.PI,m=I.noise3D(h,n,i)*Math.PI,this.dummy.position.set(a,r,-10),this.dummy.rotation.set(d,m,0),this.dummy.updateMatrix(),this.imesh.setMatrixAt(p*this.NY+l,this.dummy.matrix);this.imesh.instanceMatrix.needsUpdate=!0}}};g.render=function(t,e,i,s,o,a){const r=p("Camera"),n=p("AmbientLight"),h=p("PointLight"),d=p("BoxGeometry"),m=p("PhongMaterial"),I=p("InstancedMesh"),g=p("Plane"),N=p("Scene"),P=p("Renderer");return l(),c(P,{ref:"renderer",antialias:"",resize:"","orbit-ctrl":{enableDamping:!0,dampingFactor:.05},pointer:"",shadow:""},{default:u((()=>[f(r,{position:{z:20}}),f(N,null,{default:u((()=>[f(n,{color:"#808080"}),f(h,{ref:"light","cast-shadow":"","shadow-map-size":{width:1024,height:1024}},null,512),f(I,{ref:"imesh",count:s.NUM_INSTANCES,"cast-shadow":"","receive-shadow":""},{default:u((()=>[f(d,{size:s.SIZE},null,8,["size"]),f(m,{color:"#9C1E15"})])),_:1},8,["count"]),f(g,{width:2*s.W,height:2*s.H,position:{z:-10-s.SIZE},"receive-shadow":""},{default:u((()=>[f(m,{color:"#9C1E15"})])),_:1},8,["width","height","position"])])),_:1})])),_:1},8,["orbit-ctrl"])};export default g;
