import{o as n,c as s,d as a}from"./app.80aaf375.js";const t='{"title":"InstancedMesh","description":"","frontmatter":{},"relativePath":"guide/meshes/instanced.md","lastUpdated":1617567470056}',p={},o=a('<h1 id="instancedmesh"><a class="header-anchor" href="#instancedmesh" aria-hidden="true">#</a> InstancedMesh</h1><p>See <a href="https://github.com/troisjs/trois/blob/master/src/meshes/InstancedMesh.js" target="_blank" rel="noopener noreferrer">InstancedMesh.js</a> and <a href="https://threejs.org/docs/index.html#api/en/objects/InstancedMesh" target="_blank" rel="noopener noreferrer">THREE.InstancedMesh</a>.</p><p>Example :</p><div class="language-html"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>InstancedMesh</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>imesh<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:count</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>500<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SphereGeometry</span> <span class="token attr-name">:radius</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>5<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PhongMaterial</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#ffffff<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>InstancedMesh</span><span class="token punctuation">&gt;</span></span>\n</code></pre></div><p>You can then init instance matrix in your component script :</p><div class="language-js"><pre><code><span class="token keyword">const</span> imesh <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>imesh<span class="token punctuation">.</span>mesh<span class="token punctuation">;</span>\n<span class="token keyword">const</span> dummy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object3D</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span> randFloat<span class="token operator">:</span> rnd<span class="token punctuation">,</span> randFloatSpread<span class="token operator">:</span> rndFS <span class="token punctuation">}</span> <span class="token operator">=</span> MathUtils<span class="token punctuation">;</span>\n<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">500</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  dummy<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token function">rndFS</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">rndFS</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">rndFS</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> scale <span class="token operator">=</span> <span class="token function">rnd</span><span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  dummy<span class="token punctuation">.</span>scale<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>scale<span class="token punctuation">,</span> scale<span class="token punctuation">,</span> scale<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  dummy<span class="token punctuation">.</span><span class="token function">updateMatrix</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  imesh<span class="token punctuation">.</span><span class="token function">setMatrixAt</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> dummy<span class="token punctuation">.</span>matrix<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\nimesh<span class="token punctuation">.</span>instanceMatrix<span class="token punctuation">.</span>needsUpdate <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>\n</code></pre></div><p><strong>âš  Don&#39;t use the same material on Mesh and InstancedMesh.</strong></p>',7);p.render=function(a,t,p,e,c,u){return n(),s("div",null,[o])};export default p;export{t as __pageData};
