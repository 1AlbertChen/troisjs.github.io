import{Z as t}from"./OrbitControls.ee6c153c.js";import{A as e,B as r,a as i,I as s,f as a,p as o,c as n,d as h,S as m}from"./trois.module.05ccc66c.js";import{x as f,r as l,o as u,c as d,w as c,a as v}from"./app.ec0c195b.js";const p=new(f((function(t,e){!function(){var r=.5*(Math.sqrt(3)-1),i=(3-Math.sqrt(3))/6,s=1/6,a=(Math.sqrt(5)-1)/4,o=(5-Math.sqrt(5))/20;function n(t){var e;e="function"==typeof t?t:t?function(){var t=0,e=0,r=0,i=1,s=m();t=s(" "),e=s(" "),r=s(" ");for(var a=0;a<arguments.length;a++)(t-=s(arguments[a]))<0&&(t+=1),(e-=s(arguments[a]))<0&&(e+=1),(r-=s(arguments[a]))<0&&(r+=1);return s=null,function(){var s=2091639*t+2.3283064365386963e-10*i;return t=e,e=r,r=s-(i=0|s)}}(t):Math.random,this.p=h(e),this.perm=new Uint8Array(512),this.permMod12=new Uint8Array(512);for(var r=0;r<512;r++)this.perm[r]=this.p[255&r],this.permMod12[r]=this.perm[r]%12}function h(t){var e,r=new Uint8Array(256);for(e=0;e<256;e++)r[e]=e;for(e=0;e<255;e++){var i=e+~~(t()*(256-e)),s=r[e];r[e]=r[i],r[i]=s}return r}function m(){var t=4022871197;return function(e){e=e.toString();for(var r=0;r<e.length;r++){var i=.02519603282416938*(t+=e.charCodeAt(r));i-=t=i>>>0,t=(i*=t)>>>0,t+=4294967296*(i-=t)}return 2.3283064365386963e-10*(t>>>0)}}n.prototype={grad3:new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]),grad4:new Float32Array([0,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,1,0,1,1,1,0,1,-1,1,0,-1,1,1,0,-1,-1,-1,0,1,1,-1,0,1,-1,-1,0,-1,1,-1,0,-1,-1,1,1,0,1,1,1,0,-1,1,-1,0,1,1,-1,0,-1,-1,1,0,1,-1,1,0,-1,-1,-1,0,1,-1,-1,0,-1,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,0]),noise2D:function(t,e){var s,a,o=this.permMod12,n=this.perm,h=this.grad3,m=0,f=0,l=0,u=(t+e)*r,d=Math.floor(t+u),c=Math.floor(e+u),v=(d+c)*i,p=t-(d-v),M=e-(c-v);p>M?(s=1,a=0):(s=0,a=1);var g=p-s+i,w=M-a+i,y=p-1+2*i,I=M-1+2*i,x=255&d,A=255&c,N=.5-p*p-M*M;if(N>=0){var P=3*o[x+n[A]];m=(N*=N)*N*(h[P]*p+h[P+1]*M)}var S=.5-g*g-w*w;if(S>=0){var D=3*o[x+s+n[A+a]];f=(S*=S)*S*(h[D]*g+h[D+1]*w)}var E=.5-y*y-I*I;if(E>=0){var C=3*o[x+1+n[A+1]];l=(E*=E)*E*(h[C]*y+h[C+1]*I)}return 70*(m+f+l)},noise3D:function(t,e,r){var i,a,o,n,h,m,f,l,u,d,c=this.permMod12,v=this.perm,p=this.grad3,M=.3333333333333333*(t+e+r),g=Math.floor(t+M),w=Math.floor(e+M),y=Math.floor(r+M),I=(g+w+y)*s,x=t-(g-I),A=e-(w-I),N=r-(y-I);x>=A?A>=N?(h=1,m=0,f=0,l=1,u=1,d=0):x>=N?(h=1,m=0,f=0,l=1,u=0,d=1):(h=0,m=0,f=1,l=1,u=0,d=1):A<N?(h=0,m=0,f=1,l=0,u=1,d=1):x<N?(h=0,m=1,f=0,l=0,u=1,d=1):(h=0,m=1,f=0,l=1,u=1,d=0);var P=x-h+s,S=A-m+s,D=N-f+s,E=x-l+2*s,C=A-u+2*s,b=N-d+2*s,Z=x-1+.5,_=A-1+.5,U=N-1+.5,z=255&g,G=255&w,q=255&y,B=.6-x*x-A*A-N*N;if(B<0)i=0;else{var L=3*c[z+v[G+v[q]]];i=(B*=B)*B*(p[L]*x+p[L+1]*A+p[L+2]*N)}var V=.6-P*P-S*S-D*D;if(V<0)a=0;else{var j=3*c[z+h+v[G+m+v[q+f]]];a=(V*=V)*V*(p[j]*P+p[j+1]*S+p[j+2]*D)}var H=.6-E*E-C*C-b*b;if(H<0)o=0;else{var R=3*c[z+l+v[G+u+v[q+d]]];o=(H*=H)*H*(p[R]*E+p[R+1]*C+p[R+2]*b)}var T=.6-Z*Z-_*_-U*U;if(T<0)n=0;else{var W=3*c[z+1+v[G+1+v[q+1]]];n=(T*=T)*T*(p[W]*Z+p[W+1]*_+p[W+2]*U)}return 32*(i+a+o+n)},noise4D:function(t,e,r,i){var s,n,h,m,f,l,u,d,c,v,p,M,g,w,y,I,x,A=this.perm,N=this.grad4,P=(t+e+r+i)*a,S=Math.floor(t+P),D=Math.floor(e+P),E=Math.floor(r+P),C=Math.floor(i+P),b=(S+D+E+C)*o,Z=t-(S-b),_=e-(D-b),U=r-(E-b),z=i-(C-b),G=0,q=0,B=0,L=0;Z>_?G++:q++,Z>U?G++:B++,Z>z?G++:L++,_>U?q++:B++,_>z?q++:L++,U>z?B++:L++;var V=Z-(l=G>=3?1:0)+o,j=_-(u=q>=3?1:0)+o,H=U-(d=B>=3?1:0)+o,R=z-(c=L>=3?1:0)+o,T=Z-(v=G>=2?1:0)+2*o,W=_-(p=q>=2?1:0)+2*o,Y=U-(M=B>=2?1:0)+2*o,$=z-(g=L>=2?1:0)+2*o,F=Z-(w=G>=1?1:0)+3*o,X=_-(y=q>=1?1:0)+3*o,O=U-(I=B>=1?1:0)+3*o,k=z-(x=L>=1?1:0)+3*o,J=Z-1+4*o,K=_-1+4*o,Q=U-1+4*o,tt=z-1+4*o,et=255&S,rt=255&D,it=255&E,st=255&C,at=.6-Z*Z-_*_-U*U-z*z;if(at<0)s=0;else{var ot=A[et+A[rt+A[it+A[st]]]]%32*4;s=(at*=at)*at*(N[ot]*Z+N[ot+1]*_+N[ot+2]*U+N[ot+3]*z)}var nt=.6-V*V-j*j-H*H-R*R;if(nt<0)n=0;else{var ht=A[et+l+A[rt+u+A[it+d+A[st+c]]]]%32*4;n=(nt*=nt)*nt*(N[ht]*V+N[ht+1]*j+N[ht+2]*H+N[ht+3]*R)}var mt=.6-T*T-W*W-Y*Y-$*$;if(mt<0)h=0;else{var ft=A[et+v+A[rt+p+A[it+M+A[st+g]]]]%32*4;h=(mt*=mt)*mt*(N[ft]*T+N[ft+1]*W+N[ft+2]*Y+N[ft+3]*$)}var lt=.6-F*F-X*X-O*O-k*k;if(lt<0)m=0;else{var ut=A[et+w+A[rt+y+A[it+I+A[st+x]]]]%32*4;m=(lt*=lt)*lt*(N[ut]*F+N[ut+1]*X+N[ut+2]*O+N[ut+3]*k)}var dt=.6-J*J-K*K-Q*Q-tt*tt;if(dt<0)f=0;else{var ct=A[et+1+A[rt+1+A[it+1+A[st+1]]]]%32*4;f=(dt*=dt)*dt*(N[ct]*J+N[ct+1]*K+N[ct+2]*Q+N[ct+3]*tt)}return 27*(s+n+h+m+f)}},n._buildPermutationTable=h,e.SimplexNoise=n,t.exports=n}()}))),M={components:{AmbientLight:e,BoxGeometry:r,Camera:i,InstancedMesh:s,PhongMaterial:a,Plane:o,PointLight:n,Renderer:h,Scene:m},setup:()=>({SIZE:1.5,NX:20,NY:20,PADDING:1,SIZEP:2.5,W:49,H:49,NUM_INSTANCES:400}),data:()=>({}),mounted(){this.renderer=this.$refs.renderer,this.mouse=this.renderer.three.mouse,this.mouseV3=this.renderer.three.mouseV3,this.imesh=this.$refs.imesh.mesh,this.light=this.$refs.light.light,this.dummy=new t,this.renderer.onBeforeRender(this.animate)},methods:{animate(){this.light.position.x=this.mouseV3.x,this.light.position.y=this.mouseV3.y,this.updateInstanceMatrix()},updateInstanceMatrix(){const t=-this.W/2+this.PADDING,e=-this.H/2+this.PADDING,r=1e-4*Date.now(),i=.1*this.mouse.x,s=.1*this.mouse.y;let a,o,n,h,m,f;for(let l=0;l<this.NX;l++)for(let u=0;u<this.NY;u++)a=t+l*this.SIZEP,o=e+u*this.SIZEP,n=.005*a+i,h=.005*o+s,m=p.noise3D(n,h,r)*Math.PI,f=p.noise3D(h,n,r)*Math.PI,this.dummy.position.set(a,o,-10),this.dummy.rotation.set(m,f,0),this.dummy.updateMatrix(),this.imesh.setMatrixAt(l*this.NY+u,this.dummy.matrix);this.imesh.instanceMatrix.needsUpdate=!0}}};M.render=function(t,e,r,i,s,a){const o=l("Camera"),n=l("AmbientLight"),h=l("PointLight"),m=l("BoxGeometry"),f=l("PhongMaterial"),p=l("InstancedMesh"),M=l("Plane"),g=l("Scene"),w=l("Renderer");return u(),d(w,{ref:"renderer",antialias:"","orbit-ctrl":"","mouse-move":"","mouse-raycast":"",shadow:""},{default:c((()=>[v(o,{position:{z:20}}),v(g,null,{default:c((()=>[v(n,{color:"#808080"}),v(h,{ref:"light","cast-shadow":"","shadow-map-size":{width:1024,height:1024}},null,512),v(p,{ref:"imesh",count:i.NUM_INSTANCES,"cast-shadow":"","receive-shadow":""},{default:c((()=>[v(m,{size:i.SIZE},null,8,["size"]),v(f,{color:"#9C1E15"})])),_:1},8,["count"]),v(M,{width:2*i.W,height:2*i.H,position:{z:-10-i.SIZE},"receive-shadow":""},{default:c((()=>[v(f,{color:"#9C1E15"})])),_:1},8,["width","height","position"])])),_:1})])),_:1},512)};export default M;
