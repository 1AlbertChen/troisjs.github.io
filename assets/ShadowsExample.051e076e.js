import{a3 as t}from"./OrbitControls.94891aa4.js";import{A as e,B as i,a as s,I as o,e as r,p as a,c as n,R as h,S as d}from"./trois.module.d1f63f33.js";import{s as m}from"./simplex-noise.18d15de9.js";import{r as p,o as l,c,w as f,b as u}from"./app.66f48fd8.js";const I=new m,g={components:{AmbientLight:e,BoxGeometry:i,Camera:s,InstancedMesh:o,PhongMaterial:r,Plane:a,PointLight:n,Renderer:h,Scene:d},setup:()=>({SIZE:1.5,NX:20,NY:20,PADDING:1,SIZEP:2.5,W:49,H:49,NUM_INSTANCES:400}),data:()=>({}),mounted(){this.renderer=this.$refs.renderer,this.pointer=this.renderer.three.pointer,this.imesh=this.$refs.imesh.mesh,this.light=this.$refs.light.light,this.dummy=new t,this.renderer.onBeforeRender(this.animate)},methods:{animate(){this.light.position.x=this.pointer.positionV3.x,this.light.position.y=this.pointer.positionV3.y,this.updateInstanceMatrix()},updateInstanceMatrix(){const t=-this.W/2+this.PADDING,e=-this.H/2+this.PADDING,i=1e-4*Date.now(),s=.1*this.pointer.positionN.x,o=.1*this.pointer.positionN.y;let r,a,n,h,d,m;for(let p=0;p<this.NX;p++)for(let l=0;l<this.NY;l++)r=t+p*this.SIZEP,a=e+l*this.SIZEP,n=.005*r+s,h=.005*a+o,d=I.noise3D(n,h,i)*Math.PI,m=I.noise3D(h,n,i)*Math.PI,this.dummy.position.set(r,a,-10),this.dummy.rotation.set(d,m,0),this.dummy.updateMatrix(),this.imesh.setMatrixAt(p*this.NY+l,this.dummy.matrix);this.imesh.instanceMatrix.needsUpdate=!0}}};g.render=function(t,e,i,s,o,r){const a=p("Camera"),n=p("AmbientLight"),h=p("PointLight"),d=p("BoxGeometry"),m=p("PhongMaterial"),I=p("InstancedMesh"),g=p("Plane"),N=p("Scene"),P=p("Renderer");return l(),c(P,{ref:"renderer",antialias:"",resize:"","orbit-ctrl":{enableDamping:!0,dampingFactor:.05},pointer:"",shadow:""},{default:f((()=>[u(a,{position:{z:20}}),u(N,null,{default:f((()=>[u(n,{color:"#808080"}),u(h,{ref:"light","cast-shadow":"","shadow-map-size":{width:1024,height:1024}},null,512),u(I,{ref:"imesh",count:s.NUM_INSTANCES,"cast-shadow":"","receive-shadow":""},{default:f((()=>[u(d,{size:s.SIZE},null,8,["size"]),u(m,{color:"#9C1E15"})])),_:1},8,["count"]),u(g,{width:2*s.W,height:2*s.H,position:{z:-10-s.SIZE},"receive-shadow":""},{default:f((()=>[u(m,{color:"#9C1E15"})])),_:1},8,["width","height","position"])])),_:1})])),_:1},8,["orbit-ctrl"])};export default g;
