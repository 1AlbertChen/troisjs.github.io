import{a0 as t}from"./OrbitControls.42fcbb91.js";import{A as e,B as i,a as s,I as o,f as r,q as n,c as a,d as h,S as d}from"./trois.module.99ddcb6e.js";import{s as m}from"./simplex-noise.25c228d6.js";import{r as l,o as p,c,w as u,b as f}from"./app.80aaf375.js";const g=new m,I={components:{AmbientLight:e,BoxGeometry:i,Camera:s,InstancedMesh:o,PhongMaterial:r,Plane:n,PointLight:a,Renderer:h,Scene:d},setup:()=>({SIZE:1.5,NX:20,NY:20,PADDING:1,SIZEP:2.5,W:49,H:49,NUM_INSTANCES:400}),data:()=>({}),mounted(){this.renderer=this.$refs.renderer,this.pointer=this.renderer.three.pointer,console.log(this.pointer),this.imesh=this.$refs.imesh.mesh,this.light=this.$refs.light.light,this.dummy=new t,this.renderer.onBeforeRender(this.animate)},methods:{animate(){this.light.position.x=this.pointer.positionV3.x,this.light.position.y=this.pointer.positionV3.y,this.updateInstanceMatrix()},updateInstanceMatrix(){const t=-this.W/2+this.PADDING,e=-this.H/2+this.PADDING,i=1e-4*Date.now(),s=.1*this.pointer.positionN.x,o=.1*this.pointer.positionN.y;let r,n,a,h,d,m;for(let l=0;l<this.NX;l++)for(let p=0;p<this.NY;p++)r=t+l*this.SIZEP,n=e+p*this.SIZEP,a=.005*r+s,h=.005*n+o,d=g.noise3D(a,h,i)*Math.PI,m=g.noise3D(h,a,i)*Math.PI,this.dummy.position.set(r,n,-10),this.dummy.rotation.set(d,m,0),this.dummy.updateMatrix(),this.imesh.setMatrixAt(l*this.NY+p,this.dummy.matrix);this.imesh.instanceMatrix.needsUpdate=!0}}};I.render=function(t,e,i,s,o,r){const n=l("Camera"),a=l("AmbientLight"),h=l("PointLight"),d=l("BoxGeometry"),m=l("PhongMaterial"),g=l("InstancedMesh"),I=l("Plane"),N=l("Scene"),P=l("Renderer");return p(),c(P,{ref:"renderer",antialias:"",resize:"","orbit-ctrl":{enableDamping:!0,dampingFactor:.05},pointer:"",shadow:""},{default:u((()=>[f(n,{position:{z:20}}),f(N,null,{default:u((()=>[f(a,{color:"#808080"}),f(h,{ref:"light","cast-shadow":"","shadow-map-size":{width:1024,height:1024}},null,512),f(g,{ref:"imesh",count:s.NUM_INSTANCES,"cast-shadow":"","receive-shadow":""},{default:u((()=>[f(d,{size:s.SIZE},null,8,["size"]),f(m,{color:"#9C1E15"})])),_:1},8,["count"]),f(I,{width:2*s.W,height:2*s.H,position:{z:-10-s.SIZE},"receive-shadow":""},{default:u((()=>[f(m,{color:"#9C1E15"})])),_:1},8,["width","height","position"])])),_:1})])),_:1},8,["orbit-ctrl"])};export default I;
