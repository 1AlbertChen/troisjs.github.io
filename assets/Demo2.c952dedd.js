import{I as e,f as o,i as t,j as i}from"./trois.module.37d9a68a.js";import{f as r,n as a,r as s,o as n,c as f,w as u,b as m}from"./app.0247f905.js";import{s as d}from"./snoise2.glsl.06b34688.js";const l={components:{Camera:o,NoisyImage:r({extends:e,props:{widthSegments:{type:Number,default:20},heightSegments:{type:Number,default:20},timeCoef:{type:Number,default:.001},noiseCoef:{type:Number,default:1},zCoef:{type:Number,default:5},dispCoef:{type:Number,default:.05}},setup(e){const o={value:e.noiseCoef};a((()=>e.noiseCoef),(e=>{o.value=e}));const t={value:e.zCoef};a((()=>e.zCoef),(e=>{t.value=e}));const i={value:e.dispCoef};return a((()=>e.dispCoef),(e=>{i.value=e})),{uTime:{value:0},uNoiseCoef:o,uZCoef:t,uDispCoef:i}},created(){this.tweakMaterial(),this.startTime=Date.now(),this.renderer.onBeforeRender(this.updateTime)},unmounted(){this.renderer.offBeforeRender(this.updateTime)},methods:{tweakMaterial(){this.material.onBeforeCompile=e=>{e.uniforms.uTime=this.uTime,e.uniforms.uNoiseCoef=this.uNoiseCoef,e.uniforms.uZCoef=this.uZCoef,e.uniforms.uDispCoef=this.uDispCoef,e.vertexShader=`\n          uniform float uTime;\n          uniform float uNoiseCoef;\n          uniform float uZCoef;\n          varying float vNoise;\n          ${d}\n        `+e.vertexShader,e.vertexShader=e.vertexShader.replace("#include <begin_vertex>","         \n            vec3 p = vec3(position * uNoiseCoef);\n            p.x += uTime;\n            vNoise = snoise(p.xy);\n            vec3 transformed = vec3(position);\n            transformed.z += vNoise * uZCoef;\n          "),e.fragmentShader="\n          uniform float uDispCoef;\n          varying float vNoise;\n        "+e.fragmentShader,e.fragmentShader=e.fragmentShader.replace("#include <map_fragment>","\n            vec4 texelColor = texture2D(map, vUv);\n            vec4 dispTexel = texture2D(map, vUv + vec2(vNoise * uDispCoef, 0));\n            texelColor.r = dispTexel.r;\n            diffuseColor = texelColor;\n          "),this.materialShader=e}},updateTime(){this.uTime.value=(Date.now()-this.startTime)*this.timeCoef}},__hmrId:"NoisyImage"}),Renderer:t,Scene:i}};l.render=function(e,o,t,i,r,a){const d=s("Camera"),l=s("NoisyImage"),p=s("Scene"),c=s("Renderer");return n(),f(c,{ref:"renderer",resize:"","orbit-ctrl":{enableDamping:!0,dampingFactor:.05}},{default:u((()=>[m(d,{position:{x:0,y:0,z:100}}),m(p,{background:"#000000"},{default:u((()=>[m(l,{src:"/assets/images/img2.jpg",width:800,"time-coef":.001,"noise-coef":2,"z-coef":5,"disp-coef":.015,rotation:{x:-Math.PI/6}},null,8,["time-coef","disp-coef","rotation"])])),_:1})])),_:1},8,["orbit-ctrl"])};export default l;
